(()=>{var e={797:(e,t,r)=>{"use strict";function i(e,t,r,i,n,s,o){try{var a=e[s](o),u=a.value}catch(e){return void r(e)}a.done?t(u):Promise.resolve(u).then(i,n)}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},i=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),i.forEach((function(t){s(e,t,r[t])}))}return e}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function h(e,t,r){return(h=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}()?Reflect.construct:function(e,t,r){var i=[null];i.push.apply(i,t);var n=new(Function.bind.apply(e,i));return r&&c(n,r.prototype),n}).apply(null,arguments)}function l(e){var t="function"==typeof Map?new Map:void 0;return(l=function(e){if(null===e||(r=e,-1===Function.toString.call(r).indexOf("[native code]")))return e;var r;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,i)}function i(){return h(e,arguments,u(this).constructor)}return i.prototype=Object.create(e.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),c(i,e)})(e)}function d(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}r.r(t),r.d(t,{default:()=>p});var f=function(e){function t(e){var r;return n(this,t),(r=d(this,u(t).call(this,"Not Found! Params: ".concat(e)))).name="NotFoundError",r.stack=(new Error).stack,r}return a(t,l(Error)),t}(),v=function(e){function t(e){var r;return n(this,t),(r=d(this,u(t).call(this,"Expired! Params: ".concat(e)))).name="ExpiredError",r.stack=(new Error).stack,r}return a(t,l(Error)),t}();const p=function(){function e(){var t=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(n(this,e),this._SIZE=r.size||1e3,this.sync=r.sync||{},this.defaultExpires=void 0!==r.defaultExpires?r.defaultExpires:864e5,this.enableCache=!1!==r.enableCache,this._s=r.storageBackend||null,this._innerVersion=11,this.cache={},this._s&&this._s.setItem)try{var i=this._s.setItem("__react_native_storage_test","test");this.isPromise=!(!i||!i.then)}catch(t){throw console.warn(t),delete this._s,t}else console.warn("Data would be lost after reload cause there is no storageBackend specified!\n      \nEither use localStorage(for web) or AsyncStorage(for React Native) as a storageBackend.");this._mapPromise=this.getItem("map").then((function(e){t._m=t._checkMap(e&&JSON.parse(e)||{})}))}var t,r,s,a;return t=e,(r=[{key:"getItem",value:function(e){return this._s?this.isPromise?this._s.getItem(e):Promise.resolve(this._s.getItem(e)):Promise.resolve()}},{key:"setItem",value:function(e,t){return this._s?this.isPromise?this._s.setItem(e,t):Promise.resolve(this._s.setItem(e,t)):Promise.resolve()}},{key:"removeItem",value:function(e){return this._s?this.isPromise?this._s.removeItem(e):Promise.resolve(this._s.removeItem(e)):Promise.resolve()}},{key:"_initMap",value:function(){return{innerVersion:this._innerVersion,index:0,__keys__:{}}}},{key:"_checkMap",value:function(e){return e&&e.innerVersion&&e.innerVersion===this._innerVersion?e:this._initMap()}},{key:"_getId",value:function(e,t){return e+"_"+t}},{key:"_saveToMap",value:function(e){var t=e.key,r=e.id,i=e.data,n=this._getId(t,r),s=this._m;if(void 0!==s[n])return this.enableCache&&(this.cache[n]=JSON.parse(i)),this.setItem("map_"+s[n],i);if(void 0!==s[s.index]){var o=s[s.index],a=o.split("_");delete s[o],this._removeIdInKey(a[0],a[1]),this.enableCache&&delete this.cache[o]}if(s[n]=s.index,s[s.index]=n,s.__keys__[t]=s.__keys__[t]||[],s.__keys__[t].push(r),this.enableCache){var u=JSON.parse(i);this.cache[n]=u}var c=s.index;++s.index===this._SIZE&&(s.index=0),this.setItem("map_"+c,i),this.setItem("map",JSON.stringify(s))}},{key:"save",value:function(e){var t=this,r=e.key,i=e.id,n=e.data,s=e.rawData,o=e.expires,a=void 0===o?this.defaultExpires:o;-1!==r.toString().indexOf("_")&&console.error('Please do not use "_" in key!');var u={rawData:n};if(void 0===n){if(void 0===s)return void console.error('"data" is required in save()!');console.warn('"rawData" is deprecated, please use "data" instead!'),u.rawData=s}var c=Date.now();if(null!==a&&(u.expires=c+a),u=JSON.stringify(u),void 0===i){if(this.enableCache){var h=JSON.parse(u);this.cache[r]=h}return this.setItem(r,u)}return-1!==i.toString().indexOf("_")&&console.error('Please do not use "_" in id!'),this._mapPromise.then((function(){return t._saveToMap({key:r,id:i,data:u})}))}},{key:"getBatchData",value:function(e){var t=this;return Promise.all(e.map((function(e){return t.load(e)})))}},{key:"getBatchDataWithIds",value:(s=regeneratorRuntime.mark((function e(t){var r,i,n,s,o,a,u,c,h=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.key,i=t.ids,n=t.syncInBackground,s=t.syncParams,o=i.map((function(e){return h.load({key:r,id:e,syncInBackground:n,autoSync:!1,batched:!0})})),e.next=4,Promise.all(o);case 4:if(a=e.sent,u=[],a.forEach((function(e){void 0!==e.syncId&&u.push(e.syncId)})),!u.length){e.next=14;break}return e.next=10,this.sync[r]({id:u,syncParams:s});case 10:return c=e.sent,e.abrupt("return",a.map((function(e){return e.syncId?c.shift():e})));case 14:return e.abrupt("return",a);case 15:case"end":return e.stop()}}),e,this)})),a=function(){var e=this,t=arguments;return new Promise((function(r,n){var o=s.apply(e,t);function a(e){i(o,r,n,a,u,"next",e)}function u(e){i(o,r,n,a,u,"throw",e)}a(void 0)}))},function(e){return a.apply(this,arguments)})},{key:"_lookupGlobalItem",value:function(e){var t=this,r=e.key;return this.enableCache&&void 0!==this.cache[r]?this._loadGlobalItem(o({ret:this.cache[r]},e)):this.getItem(r).then((function(r){return t._loadGlobalItem(o({ret:r},e))}))}},{key:"_loadGlobalItem",value:function(e){var t=e.key,r=e.ret,i=e.autoSync,n=e.syncInBackground,s=e.syncParams;if(null==r){if(i&&this.sync[t])return this.sync[t]({syncParams:s});throw new f(JSON.stringify(e))}"string"==typeof r&&(r=JSON.parse(r),this.enableCache&&(this.cache[t]=r));var o=Date.now();if(r.expires<o){if(i&&this.sync[t]){if(n){try{this.sync[t]({syncParams:s,syncInBackground:n})}catch(e){}return r.rawData}return this.sync[t]({syncParams:s,syncInBackground:n})}throw new v(JSON.stringify(e))}return r.rawData}},{key:"_noItemFound",value:function(e){var t=e.key,r=e.id,i=e.autoSync,n=e.syncParams;if(this.sync[t])return i?this.sync[t]({id:r,syncParams:n}):{syncId:r};throw new f(JSON.stringify(e))}},{key:"_loadMapItem",value:function(e){var t=e.ret,r=e.key,i=e.id,n=e.autoSync,s=e.batched,o=e.syncInBackground,a=e.syncParams;if(null==t)return this._noItemFound(e);if("string"==typeof t){t=JSON.parse(t);var u=e.key,c=e.id,h=this._getId(u,c);this.enableCache&&(this.cache[h]=t)}var l=Date.now();if(t.expires<l){if(n&&this.sync[r]){if(o){try{this.sync[r]({id:i,syncParams:a,syncInBackground:o})}catch(e){}return t.rawData}return this.sync[r]({id:i,syncParams:a,syncInBackground:o})}if(s)return{syncId:i};throw new v(JSON.stringify(e))}return t.rawData}},{key:"_lookUpInMap",value:function(e){var t,r=this,i=this._m,n=e.key,s=e.id,a=this._getId(n,s);return this.enableCache&&this.cache[a]?(t=this.cache[a],this._loadMapItem(o({ret:t},e))):void 0!==i[a]?this.getItem("map_"+i[a]).then((function(t){return r._loadMapItem(o({ret:t},e))})):this._noItemFound(o({ret:t},e))}},{key:"remove",value:function(e){var t=this;return this._mapPromise.then((function(){var r=t._m,i=e.key,n=e.id;if(void 0===n)return t.enableCache&&t.cache[i]&&delete t.cache[i],t.removeItem(i);var s=t._getId(i,n);if(void 0!==r[s]){t.enableCache&&t.cache[s]&&delete t.cache[s],t._removeIdInKey(i,n);var o=r[s];return delete r[s],t.setItem("map",JSON.stringify(r)),t.removeItem("map_"+o)}}))}},{key:"_removeIdInKey",value:function(e,t){var r=(this._m.__keys__[e]||[]).indexOf(t);-1!==r&&this._m.__keys__[e].splice(r,1)}},{key:"load",value:function(e){var t=this,r=e.key,i=e.id,n=e.autoSync,s=void 0===n||n,o=e.syncInBackground,a=void 0===o||o,u=e.syncParams,c=e.batched;return this._mapPromise.then((function(){return void 0===i?t._lookupGlobalItem({key:r,autoSync:s,syncInBackground:a,syncParams:u}):t._lookUpInMap({key:r,id:i,autoSync:s,syncInBackground:a,batched:c,syncParams:u})}))}},{key:"clearAll",value:function(){this._s.clear&&this._s.clear(),this._m=this._initMap()}},{key:"clearMap",value:function(){var e=this;return this.removeItem("map").then((function(){e.cache={},e._m=e._initMap()}))}},{key:"clearMapForKey",value:function(e){var t=this;return this._mapPromise.then((function(){var r=(t._m.__keys__[e]||[]).map((function(r){return t.remove({key:e,id:r})}));return Promise.all(r)}))}},{key:"getIdsForKey",value:function(e){var t=this;return this._mapPromise.then((function(){return t._m.__keys__[e]||[]}))}},{key:"getAllDataForKey",value:function(e,t){var r=this;return t=Object.assign({syncInBackground:!0},t),this.getIdsForKey(e).then((function(i){var n=i.map((function(r){return{key:e,id:r,syncInBackground:t.syncInBackground}}));return r.getBatchData(n)}))}}])&&function(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}(t.prototype,r),e}()},666:e=>{var t=function(e){"use strict";var t,r=Object.prototype,i=r.hasOwnProperty,n=Object.defineProperty||function(e,t,r){e[t]=r.value},s="function"==typeof Symbol?Symbol:{},o=s.iterator||"@@iterator",a=s.asyncIterator||"@@asyncIterator",u=s.toStringTag||"@@toStringTag";function c(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,r){return e[t]=r}}function h(e,t,r,i){var s=t&&t.prototype instanceof y?t:y,o=Object.create(s.prototype),a=new T(i||[]);return n(o,"_invoke",{value:k(e,r,a)}),o}function l(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=h;var d="suspendedStart",f="executing",v="completed",p={};function y(){}function g(){}function m(){}var _={};c(_,o,(function(){return this}));var w=Object.getPrototypeOf,b=w&&w(w(A([])));b&&b!==r&&i.call(b,o)&&(_=b);var I=m.prototype=y.prototype=Object.create(_);function O(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function P(e,t){function r(n,s,o,a){var u=l(e[n],e,s);if("throw"!==u.type){var c=u.arg,h=c.value;return h&&"object"==typeof h&&i.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,o,a)}),(function(e){r("throw",e,o,a)})):t.resolve(h).then((function(e){c.value=e,o(c)}),(function(e){return r("throw",e,o,a)}))}a(u.arg)}var s;n(this,"_invoke",{value:function(e,i){function n(){return new t((function(t,n){r(e,i,t,n)}))}return s=s?s.then(n,n):n()}})}function k(e,t,r){var i=d;return function(n,s){if(i===f)throw new Error("Generator is already running");if(i===v){if("throw"===n)throw s;return S()}for(r.method=n,r.arg=s;;){var o=r.delegate;if(o){var a=x(o,r);if(a){if(a===p)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===d)throw i=v,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=f;var u=l(e,t,r);if("normal"===u.type){if(i=r.done?v:"suspendedYield",u.arg===p)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(i=v,r.method="throw",r.arg=u.arg)}}}function x(e,r){var i=e.iterator[r.method];if(i===t){if(r.delegate=null,"throw"===r.method){if(e.iterator.return&&(r.method="return",r.arg=t,x(e,r),"throw"===r.method))return p;r.method="throw",r.arg=new TypeError("The iterator does not provide a 'throw' method")}return p}var n=l(i,e.iterator,r.arg);if("throw"===n.type)return r.method="throw",r.arg=n.arg,r.delegate=null,p;var s=n.arg;return s?s.done?(r[e.resultName]=s.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,p):s:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,p)}function E(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function j(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function T(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function A(e){if(e){var r=e[o];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,s=function r(){for(;++n<e.length;)if(i.call(e,n))return r.value=e[n],r.done=!1,r;return r.value=t,r.done=!0,r};return s.next=s}}return{next:S}}function S(){return{value:t,done:!0}}return g.prototype=m,n(I,"constructor",{value:m,configurable:!0}),n(m,"constructor",{value:g,configurable:!0}),g.displayName=c(m,u,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,m):(e.__proto__=m,c(e,u,"GeneratorFunction")),e.prototype=Object.create(I),e},e.awrap=function(e){return{__await:e}},O(P.prototype),c(P.prototype,a,(function(){return this})),e.AsyncIterator=P,e.async=function(t,r,i,n,s){void 0===s&&(s=Promise);var o=new P(h(t,r,i,n),s);return e.isGeneratorFunction(r)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},O(I),c(I,u,"Generator"),c(I,o,(function(){return this})),c(I,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),r=[];for(var i in t)r.push(i);return r.reverse(),function e(){for(;r.length;){var i=r.pop();if(i in t)return e.value=i,e.done=!1,e}return e.done=!0,e}},e.values=A,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(j),!e)for(var r in this)"t"===r.charAt(0)&&i.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(i,n){return a.type="throw",a.arg=e,r.next=i,n&&(r.method="next",r.arg=t),!!n}for(var s=this.tryEntries.length-1;s>=0;--s){var o=this.tryEntries[s],a=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var u=i.call(o,"catchLoc"),c=i.call(o,"finallyLoc");if(u&&c){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(u){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&i.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var s=n;break}}s&&("break"===e||"continue"===e)&&s.tryLoc<=t&&t<=s.finallyLoc&&(s=null);var o=s?s.completion:{};return o.type=e,o.arg=t,s?(this.method="next",this.next=s.finallyLoc,p):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),j(r),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var i=r.completion;if("throw"===i.type){var n=i.arg;j(r)}return n}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,i){return this.delegate={iterator:A(e),resultName:r,nextLoc:i},"next"===this.method&&(this.arg=t),p}},e}(e.exports);try{regeneratorRuntime=t}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=t:Function("r","regeneratorRuntime = r")(t)}},566:function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,s){function o(e){try{u(i.next(e))}catch(e){s(e)}}function a(e){try{u(i.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}u((i=i.apply(e,t||[])).next())}))},n=this&&this.__asyncValues||function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(r){t[r]=e[r]&&function(t){return new Promise((function(i,n){!function(e,t,r,i){Promise.resolve(i).then((function(t){e({value:t,done:r})}),t)}(i,n,(t=e[r](t)).done,t.value)}))}}},s=this&&this.__await||function(e){return this instanceof s?(this.v=e,this):new s(e)},o=this&&this.__asyncGenerator||function(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,n=r.apply(e,t||[]),o=[];return i={},a("next"),a("throw"),a("return"),i[Symbol.asyncIterator]=function(){return this},i;function a(e){n[e]&&(i[e]=function(t){return new Promise((function(r,i){o.push([e,t,r,i])>1||u(e,t)}))})}function u(e,t){try{(r=n[e](t)).value instanceof s?Promise.resolve(r.value.v).then(c,h):l(o[0][2],r)}catch(e){l(o[0][3],e)}var r}function c(e){u("next",e)}function h(e){u("throw",e)}function l(e,t){e(t),o.shift(),o.length&&u(o[0][0],o[0][1])}};Object.defineProperty(t,"__esModule",{value:!0}),t.Drivers=void 0;const a=r(6);t.Drivers=class{getDriver({driverId:e,risk:t=!0,address:r=!0,fleets:n=!0,vehicleCount:s=!1,distance:o=!1,points:u=!0,files:c=!0,contact:h=!0,occupation:l=!0}){return i(this,void 0,void 0,(function*(){let i={risk:t,address:r,fleets:n,vehicleCount:s,distance:o,points:u,files:c,contact:h,occupation:l},d=yield this.api.request({method:"GET",endpoint:`drivers/${e}`,params:i}),f=new a.Driver(d);return f.api=this.api,f}))}listDrivers({dob:e,email:t,firstName:r,lastName:i,externalId:u,isActive:c,maxRecords:h}){return o(this,arguments,(function*(){var o,l;let d=0,f={};e&&(f=Object.assign(Object.assign({},f),{dob:String(e)})),t&&(f=Object.assign(Object.assign({},f),{email:String(t)})),r&&(f=Object.assign(Object.assign({},f),{firstName:String(r)})),i&&(f=Object.assign(Object.assign({},f),{lastName:String(i)})),u&&(f=Object.assign(Object.assign({},f),{externalId:String(u)})),c&&(f=Object.assign(Object.assign({},f),{isActive:c}));try{for(var v,p=n(this.api.batchFetch({endpoint:"drivers",params:f}));!(v=yield s(p.next())).done;){let e=v.value;if(h&&d>=h)break;let t=new a.Driver(e);t.api=this.api,yield yield s(t),d++}}catch(e){o={error:e}}finally{try{v&&!v.done&&(l=p.return)&&(yield s(l.call(p)))}finally{if(o)throw o.error}}}))}createDriver({driver:e,password:t,sendInvite:r,sendWebhook:n}){return i(this,void 0,void 0,(function*(){if(!t&&!r)throw new Error("You must provide a password if sendInvite is false");if(t&&r)throw new Error("You cannot provide a password if sendInvite is true");let i=yield this.api.request({method:"POST",endpoint:"drivers",data:Object.assign(Object.assign({},e),{password:t}),params:{webhook:n?"true":"false",invite:r?"true":"false"}}),s=new a.Driver(i);return s.api=this.api,s}))}}},706:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(566);t.default=i.Drivers},400:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Fleets=void 0,t.Fleets=class{constructor(){}}},503:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(400);t.default=i.Fleets},929:function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,s){function o(e){try{u(i.next(e))}catch(e){s(e)}}function a(e){try{u(i.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}u((i=i.apply(e,t||[])).next())}))},n=this&&this.__asyncValues||function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(r){t[r]=e[r]&&function(t){return new Promise((function(i,n){!function(e,t,r,i){Promise.resolve(i).then((function(t){e({value:t,done:r})}),t)}(i,n,(t=e[r](t)).done,t.value)}))}}},s=this&&this.__await||function(e){return this instanceof s?(this.v=e,this):new s(e)},o=this&&this.__asyncGenerator||function(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,n=r.apply(e,t||[]),o=[];return i={},a("next"),a("throw"),a("return"),i[Symbol.asyncIterator]=function(){return this},i;function a(e){n[e]&&(i[e]=function(t){return new Promise((function(r,i){o.push([e,t,r,i])>1||u(e,t)}))})}function u(e,t){try{(r=n[e](t)).value instanceof s?Promise.resolve(r.value.v).then(c,h):l(o[0][2],r)}catch(e){l(o[0][3],e)}var r}function c(e){u("next",e)}function h(e){u("throw",e)}function l(e,t){e(t),o.shift(),o.length&&u(o[0][0],o[0][1])}};Object.defineProperty(t,"__esModule",{value:!0}),t.Vehicles=void 0;const a=r(794);t.Vehicles=class{getVehicle({vehicleId:e,includeTranslations:t=!0,includeDistance:r=!0,includeDrvCount:n=!0}){return i(this,void 0,void 0,(function*(){let i={drv:!0,trns:t,distance3m:r,totalDrvCount:n},s=yield this.api.request({method:"GET",endpoint:`registered-vehicles/${e}`,params:i}),o=new a.Vehicle(s);return o.api=this.api,o}))}listVehicles({regPlate:e,vin:t,isActive:r,isApproved:i,fullResponse:u,maxRecords:c}){return o(this,arguments,(function*(){var o,h;let l=0;try{for(var d,f=n(this.api.batchFetch({endpoint:"registered-vehicles",params:{regPlate:e,vin:t,isActive:r,isApproved:i,full:u?"true":"false"}}));!(d=yield s(f.next())).done;){let e=d.value;if(c&&l>=c)break;let t=new a.Vehicle(e);t.api=this.api,yield yield s(t),l++}}catch(e){o={error:e}}finally{try{d&&!d.done&&(h=f.return)&&(yield s(h.call(f)))}finally{if(o)throw o.error}}}))}createVehicle({vehicle:e,driverId:t,drv:r,sendWebhook:n=!0}){var s;return i(this,void 0,void 0,(function*(){if(!t&&r)throw new Error("You must provide a driverId if drv is provided");if(!e.vehicle)throw new Error("You must provide a vehicleType");if(!(null===(s=e.vehicle)||void 0===s?void 0:s.id))throw new Error("Vehicle Type ID is required");let i=yield this.api.request({method:"POST",endpoint:"registered-vehicles",data:Object.assign(Object.assign({},e),{vehicleId:e.vehicle.id}),params:{webhook:n?"true":"false"}}),o=new a.Vehicle(i);return o.api=this.api,o}))}}},972:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(929);t.default=i.Vehicles},607:function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,s){function o(e){try{u(i.next(e))}catch(e){s(e)}}function a(e){try{u(i.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}u((i=i.apply(e,t||[])).next())}))},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),r(666);const s=r(267),o=n(r(133)),a=n(r(96)),u=r(465),c=n(r(706)),h=n(r(972)),l=n(r(503)),d=r(486);class f{constructor({orgId:e,region:t,url:r,auth:i,storage:n=null}){o.default.createStorage(n),this.orgId=e,this.region=t,this.url=r,this.storageManager=o.default.getInstance(),this.auth=i,this.auth?this.api=new s.APIHandlerAuth({orgId:this.orgId,region:this.region,url:this.url,auth:this.auth}):this.api=new s.APIHandlerNoAuth({orgId:this.orgId,region:this.region,url:this.url})}orgSettings(){return i(this,void 0,void 0,(function*(){return this.api.orgData||(yield this.api.refreshOrgData()),this.api.orgData}))}request({method:e,path:t,params:r,data:n}){return i(this,void 0,void 0,(function*(){return yield this.api.request({method:e,endpoint:t,params:r,data:n})}))}}(0,u.applyMixins)(f,[c.default,h.default,l.default]);let v={Motor:f,Auth:a.default,Search:d.Search};Function("r","motorJS = r")(v),t.default=v},479:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BillingAccount=void 0,t.BillingAccount=class{constructor(e){Object.assign(this,e)}getDisplay(){return this.card?`${this.isPrimary?"Primary ":""}${this.card.name} - ${this.card.lastFour}`:"Unknown"}}},952:function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,s){function o(e){try{u(i.next(e))}catch(e){s(e)}}function a(e){try{u(i.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}u((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.PrivateApiHandler=void 0;const n=r(465);t.PrivateApiHandler=class{_update({persist:e,endpoint:t,fields:r,exclude:n,params:s}){return i(this,void 0,void 0,(function*(){r&&(Object.assign(this,Object.assign(Object.assign({},this),r)),e&&t&&(yield this._save({endpoint:t,fields:r,exclude:n,params:s})))}))}_save({endpoint:e,fields:t,exclude:r=[],params:s}){return i(this,void 0,void 0,(function*(){if(!this.api)throw new Error("APIHandler not initialised");let i=null;if(t)i=Object.assign({},t);else{i=Object.assign({},this),r=r.concat(["api","id","createdAt"]);for(let e of r)(0,n.deleteFromObject)(e,i)}if(t)return this.api.request({method:"PATCH",endpoint:e,params:s,data:i})}))}}},6:function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,s){function o(e){try{u(i.next(e))}catch(e){s(e)}}function a(e){try{u(i.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}u((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Driver=void 0;const n=r(952),s=r(479),o=r(324);class a extends n.PrivateApiHandler{constructor(e){super(),Object.assign(this,e)}_checkId(){if(!this.id)throw new Error("ID must be set")}fullName(){return`${this.firstName} ${this.lastName}`}refresh(){return i(this,void 0,void 0,(function*(){let e=yield this.api.request({method:"GET",endpoint:`drivers/${this.id}`,params:{risk:!0,address:!0,fleets:!0,vehicleCount:!0,distance:!0,points:!0,files:!0,contact:!0,occupation:!0}});e.api=this.api,Object.assign(this,e)}))}delete(){return i(this,void 0,void 0,(function*(){this._checkId(),yield this.api.request({method:"DELETE",endpoint:`vehicles/${this.id}`})}))}save(e={}){return i(this,void 0,void 0,(function*(){this._checkId(),yield this._save({endpoint:`drivers/${this.id}`,fields:e,exclude:["fleets","createdAt"]})}))}update({persist:e=!1,fields:t={}}){return i(this,void 0,void 0,(function*(){yield this._update({endpoint:`drivers/${this.id}`,persist:e,fields:t,exclude:["fleets","createdAt"]})}))}listVehicles(){return i(this,void 0,void 0,(function*(){return(yield this.api.request({method:"GET",endpoint:`drivers/${this.id}/vehicles`})).map((e=>{let t=new o.DriverVehicle(e);return t.api=this.api,t}))}))}getDisplay(){return this.fullName()}telematicsId(){return this.sourceId}listBillingAccounts(e=!1){return i(this,void 0,void 0,(function*(){return this._checkId(),(yield this.api.request({method:"GET",endpoint:`drivers/${this.id}/billing-accounts`})).map((e=>{let t=new s.BillingAccount(e);return t.api=this.api,t}))}))}}t.Driver=a},259:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.regions=void 0,(r=t.regions||(t.regions={})).eu1="eu-1",r.dev_eu1="dev-eu-1",r.me1="me-1",r.us1="us-1"},324:function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,s){function o(e){try{u(i.next(e))}catch(e){s(e)}}function a(e){try{u(i.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}u((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.DriverVehicle=void 0;const n=r(794),s=r(952);class o extends s.PrivateApiHandler{constructor(e){super(),e.registeredVehicle=e.registeredVehicle?new n.Vehicle(e.registeredVehicle):void 0,Object.assign(this,e)}_checkId(){if(!this.id)throw new Error("ID must be set")}getDisplay(){var e;return this.registeredVehicle?`${this.displayName} ${null===(e=this.registeredVehicle)||void 0===e?void 0:e.getDisplay()}`:this.displayName||"Unknown"}telematicsId(){return this.sourceId}refresh(){return i(this,void 0,void 0,(function*(){this._checkId();let e=yield this.api.request({method:"GET",endpoint:`drivers/${this.driverId}/vehicles/${this.id}`});e.registeredVehicle=e.registeredVehicle?new n.Vehicle(e.registeredVehicle):void 0,e.api=this.api,Object.assign(this,e)}))}delete(){return i(this,void 0,void 0,(function*(){this._checkId(),yield this.api.request({method:"DELETE",endpoint:`drivers/${this.driverId}/vehicles/${this.id}`})}))}save(e={}){return i(this,void 0,void 0,(function*(){this._checkId(),yield this._save({endpoint:`drivers/${this.driverId}/vehicles/${this.id}`,fields:e,exclude:["driverId","vehicle"]})}))}update({persist:e=!1,fields:t={}}){return i(this,void 0,void 0,(function*(){yield this._update({endpoint:`drivers/${this.driverId}/vehicles/${this.id}`,persist:e,fields:t,exclude:["driverId","vehicle"]})}))}}t.DriverVehicle=o},794:function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,s){function o(e){try{u(i.next(e))}catch(e){s(e)}}function a(e){try{u(i.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}u((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Vehicle=void 0;const n=r(952),s=r(455);class o extends n.PrivateApiHandler{constructor(e){super(),e.vehicle=e.vehicle?new s.VehicleType(e.vehicle):void 0,Object.assign(this,e)}_checkId(){if(!this.id)throw new Error("ID must be set")}getDisplay(){var e;return this.vehicle?`${null===(e=this.vehicle)||void 0===e?void 0:e.getDisplay()} - ${this.regPlate}`:this.regPlate||"Unknown"}refresh(){return i(this,void 0,void 0,(function*(){this._checkId();let e=yield this.api.request({method:"GET",endpoint:`registered-vehicles/${this.id}`});e.api=this.api,Object.assign(this,e)}))}delete(){return i(this,void 0,void 0,(function*(){this._checkId(),yield this.api.request({method:"DELETE",endpoint:`registered-vehicles/${this.id}`})}))}save(e={}){return i(this,void 0,void 0,(function*(){this._checkId(),yield this._save({endpoint:`registered-vehicles/${this.id}`,fields:e,exclude:["vehicleType"]})}))}update({persist:e=!1,fields:t={}}){return i(this,void 0,void 0,(function*(){yield this._update({endpoint:`vehicles/${this.id}`,persist:e,fields:t,exclude:["vehicleType"]})}))}}t.Vehicle=o},455:function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,s){function o(e){try{u(i.next(e))}catch(e){s(e)}}function a(e){try{u(i.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}u((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.VehicleType=void 0;const n=r(952);class s extends n.PrivateApiHandler{constructor(e){super(),Object.assign(this,e)}_checkId(){if(!this.id)throw new Error("ID must be set")}getDisplay(){return`${this.brand} (${this.model})`}refresh(){return i(this,void 0,void 0,(function*(){this._checkId();let e=yield this.api.request({method:"GET",endpoint:`vehicles/${this.id}`});e.api=this.api,Object.assign(this,e)}))}delete(){return i(this,void 0,void 0,(function*(){this._checkId(),yield this.api.request({method:"DELETE",endpoint:`vehicles/${this.id}`})}))}save(e={}){return i(this,void 0,void 0,(function*(){this._checkId(),yield this._save({endpoint:`vehicles/${this.id}`,fields:e})}))}update({persist:e=!1,fields:t={}}){return i(this,void 0,void 0,(function*(){yield this._update({endpoint:`vehicles/${this.id}`,persist:e,fields:t})}))}}t.VehicleType=s},941:function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,s){function o(e){try{u(i.next(e))}catch(e){s(e)}}function a(e){try{u(i.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}u((i=i.apply(e,t||[])).next())}))},n=this&&this.__await||function(e){return this instanceof n?(this.v=e,this):new n(e)},s=this&&this.__asyncGenerator||function(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,s=r.apply(e,t||[]),o=[];return i={},a("next"),a("throw"),a("return"),i[Symbol.asyncIterator]=function(){return this},i;function a(e){s[e]&&(i[e]=function(t){return new Promise((function(r,i){o.push([e,t,r,i])>1||u(e,t)}))})}function u(e,t){try{(r=s[e](t)).value instanceof n?Promise.resolve(r.value.v).then(c,h):l(o[0][2],r)}catch(e){l(o[0][3],e)}var r}function c(e){u("next",e)}function h(e){u("throw",e)}function l(e,t){e(t),o.shift(),o.length&&u(o[0][0],o[0][1])}},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.APIHandlerAuth=t.APIHandlerNoAuth=void 0;const a=r(259),u=o(r(890)),c=r(974);t.APIHandlerNoAuth=class{constructor({url:e,region:t,orgId:r}){if(this.url=e,this.region=t,this.orgId=r,this.orgDataRefreshing=!1,!this.url&&!this.region)throw new Error("Must provide either a url or a region");if(this.url&&this.url.endsWith("/")&&(this.url=this.url.slice(0,-1)),!this.url){if(t&&!Object.values(a.regions).includes(t))throw new Error(`Invalid region. Must be one of: ${Object.values(a.regions).join(", ")}`);this.url=`https://${this.region}.nsurely-motor.com/v1/api`}this.telematicsUrl=`https://${this.region}.nsurely-motor.com/v1/telematics`,this.orgUrl=`${this.url}/org/${this.orgId}`}request({method:e,endpoint:t,params:r,data:n,headers:s,urlOverride:o}){return i(this,void 0,void 0,(function*(){this.orgData||this.orgDataRefreshing||(this.orgDataRefreshing=!0,this.refreshOrgData());let{body:i,status:a}=yield(0,u.default)({method:e,url:o||`${this.orgUrl}/${t}`,params:r,data:n,headers:s});if(a<300)return i;throw 401===a?new c.APIAuthError("Not authenticated"):new c.APIError(`Api responded with status code ${a}`)}))}refreshOrgData(){return i(this,void 0,void 0,(function*(){this.orgDataRefreshing=!0,this.orgData=yield this.request({urlOverride:`${this.url}/public/${this.orgId}`,method:"GET"}),this.orgDataRefreshing=!1}))}batchFetch({endpoint:e,params:t,headers:r,limit:i=50,offset:o=0}){return s(this,arguments,(function*(){for(t=Object.assign(Object.assign({},t),{limit:i,offset:o});;){let s=yield n(this.request({method:"GET",endpoint:e,params:Object.assign(Object.assign({},t),{offset:o}),headers:r}));if(!s||0===s.length)break;for(let e of s)yield yield n(e);if(s.length<i)break;o+=i}}))}},t.APIHandlerAuth=class{constructor({url:e,region:t,orgId:r,auth:i}){if(this.url=e,this.region=t,this.orgId=r,this.auth=i,this.orgDataRefreshing=!1,!this.url&&!this.region)throw new Error("Must provide either a url or a region");if(this.url&&this.url.endsWith("/")&&(this.url=this.url.slice(0,-1)),!this.url){if(t&&!Object.values(a.regions).includes(t))throw new Error(`Invalid region. Must be one of: ${Object.values(a.regions).join(", ")}`);this.url=`https://${this.region}.nsurely-motor.com/v1/api`}this.telematicsUrl=`https://${this.region}.nsurely-motor.com/v1/telematics`,this.orgUrl=`${this.url}/org/${this.orgId}`}makeRequest({method:e,params:t,data:r,headers:n,url:s}){return i(this,void 0,void 0,(function*(){return this.auth.requiresRefresh()&&(yield this.auth.refresh()),n=Object.assign(Object.assign({},n),this.auth.getHeaders()),yield(0,u.default)({method:e,url:s,params:t,data:r,headers:n})}))}refreshOrgData(){return i(this,void 0,void 0,(function*(){this.orgDataRefreshing=!0,this.orgData=yield this.request({urlOverride:`${this.url}/public/${this.orgId}`,method:"GET"}),this.orgDataRefreshing=!1}))}authOk(){return!!this.auth.isLoggedIn()&&!this.auth.requiresRefresh()}checkAuth(){return i(this,void 0,void 0,(function*(){if(!this.authOk()){if(!this.auth.isLoggedIn())return void(yield this.auth.login());if(this.auth.requiresRefresh())return void(yield this.auth.refresh())}}))}request({method:e,endpoint:t,params:r,data:n,headers:s,urlOverride:o}){return i(this,void 0,void 0,(function*(){this.orgData||this.orgDataRefreshing||(this.orgDataRefreshing=!0,yield this.refreshOrgData()),yield this.checkAuth();let i=yield this.makeRequest({method:e,url:o||`${this.orgUrl}/${t}`,params:r,data:n,headers:s}),a=(null==i?void 0:i.body)||{},u=(null==i?void 0:i.status)||0;if(401===u){yield this.checkAuth(),s=Object.assign(Object.assign({},s),this.auth.getHeaders());let i=yield this.makeRequest({method:e,url:o||`${this.orgUrl}/${t}`,params:r,data:n,headers:s});a=(null==i?void 0:i.body)||{},u=(null==i?void 0:i.status)||0}if(u<300)return a;throw 401===u?new c.APIAuthError("Not authenticated"):new c.APIError(`Api responded with status code ${u}`)}))}batchFetch({endpoint:e,params:t,headers:r,limit:i=50,offset:o=0}){return s(this,arguments,(function*(){for(t=Object.assign(Object.assign({},t),{limit:i,offset:o});;){let s=yield n(this.request({method:"GET",endpoint:e,params:Object.assign(Object.assign({},t),{offset:o}),headers:r}));if(!s||0===s.length)break;for(let e of s)yield yield n(e);if(s.length<i)break;o+=i}}))}}},974:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.APIAuthError=t.APIError=void 0;class r extends Error{constructor(e){super(e),this.name="APIError"}}t.APIError=r,t.APIAuthError=class extends r{constructor(e){super(e),this.name="APIAuthError"}}},267:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.APIHandlerNoAuth=t.APIHandlerAuth=void 0;const i=r(941);Object.defineProperty(t,"APIHandlerAuth",{enumerable:!0,get:function(){return i.APIHandlerAuth}}),Object.defineProperty(t,"APIHandlerNoAuth",{enumerable:!0,get:function(){return i.APIHandlerNoAuth}})},734:function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,s){function o(e){try{u(i.next(e))}catch(e){s(e)}}function a(e){try{u(i.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}u((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.APIKeyAuth=void 0;const n=r(66);t.APIKeyAuth=class{constructor(e,t){if(this.apiKey=e,this.apiSecret=t,this.headers=void 0,!this.apiKey)throw new n.APIKeyAuthError("API key is required.");if(!this.apiSecret)throw new n.APIKeyAuthError("API secret is required.");this.apiKey=this.apiKey.trim(),this.apiSecret=this.apiSecret.trim()}requiresRefresh(){return!1}refresh(){return i(this,void 0,void 0,(function*(){}))}getToken(){return`${this.apiKey}:${this.apiSecret}`}getHeaders(){return this.headers||(this.headers={Authorization:`apiKey ${this.getToken()}`}),this.headers}isLoggedIn(){return!0}login(){return i(this,void 0,void 0,(function*(){return!0}))}logout(){return i(this,void 0,void 0,(function*(){return!0}))}}},808:function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,s){function o(e){try{u(i.next(e))}catch(e){s(e)}}function a(e){try{u(i.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}u((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Auth=void 0;const n=r(66),s=r(734),o=r(506),a=r(537),u=r(259);var c;!function(e){e[e.API_KEY=1]="API_KEY",e[e.JWT_DRIVER=2]="JWT_DRIVER",e[e.JWT_USER=3]="JWT_USER"}(c||(c={})),t.Auth=class{constructor({apiKey:e,apiSecret:t,email:r,password:i,accountType:h,orgId:l,region:d,url:f}){if(this.apiKey=e,this.apiSecret=t,this.email=r,this.password=i,this.accountType=h,this.region=d,this.url=f,this.orgId=l,this.isLoggingIn=!1,this.url&&this.url.endsWith("/")&&(this.url=this.url.slice(0,-1)),!this.url){if(d&&!Object.values(u.regions).includes(d))throw new Error(`Invalid region. Must be one of: ${Object.values(u.regions).join(", ")}`);this.url=`https://${this.region}.nsurely-motor.com/v1/api`}if(this.apiKey){if(!this.apiSecret){if(-1===this.apiKey.indexOf(":"))throw new n.AuthError('Invalid API key. API key must be in the format "key:secret".');[this.apiKey,this.apiSecret]=this.apiKey.split(":")}this.authMethod=c.API_KEY,this.authObject=new s.APIKeyAuth(this.apiKey,this.apiSecret)}else{if(!this.email||!this.password)throw new n.AuthError("Auth credentials are missing.");if(!this.accountType)throw new n.AuthError("Account type must be specified.");if("driver"===this.accountType)this.authMethod=c.JWT_DRIVER,this.authObject=new o.DriverAuth({email:this.email,password:this.password,url:this.url,region:this.region,orgId:this.orgId,authType:this.accountType});else{if("user"!==this.accountType)throw new n.AuthError("Invalid account type.");this.authMethod=c.JWT_USER,this.authObject=new a.UserAuth({email:this.email,password:this.password,url:this.url,region:this.region,orgId:this.orgId,authType:this.accountType})}}}requiresRefresh(){return this.authObject.requiresRefresh()}refresh(){return i(this,void 0,void 0,(function*(){yield this.authObject.refresh()}))}login(){return i(this,void 0,void 0,(function*(){if(this.authMethod===c.API_KEY)return!0;if(this.isLoggingIn)return yield new Promise((e=>{const t=setInterval((()=>{this.isLoggingIn||(clearInterval(t),e(this.authObject.getToken()))}),100)}));if(this.isLoggingIn=!0,this.email&&this.password){let e=yield this.authObject.login(this.email,this.password);return this.isLoggingIn=!1,e}throw new n.AuthError("Auth credentials are missing.")}))}logout(){return i(this,void 0,void 0,(function*(){return yield this.authObject.logout()}))}getToken(){return this.authObject.getToken()}getHeaders(){return this.authObject.getHeaders()}isLoggedIn(){return this.authObject.isLoggedIn()}}},506:function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,s){function o(e){try{u(i.next(e))}catch(e){s(e)}}function a(e){try{u(i.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}u((i=i.apply(e,t||[])).next())}))},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.DriverAuth=void 0;const s=r(88),o=n(r(890));class a extends s.JWTAuth{constructor({url:e,region:t,orgId:r,authType:i,email:n,password:s}){super({url:e,region:t,orgId:r,authType:i,email:n,password:s})}signup({email:e,password:t,firstName:r,lastName:n,fields:s,login:a}){return i(this,void 0,void 0,(function*(){s=s||{};const i=Object.assign({email:e,password:t,firstName:r,lastName:n},s),u=yield(0,o.default)({url:`${this.url}/org/${this.orgId}/auth/drivers/signup`,method:"POST",data:i});return a&&(yield this.login(e,t)),u.body}))}}t.DriverAuth=a},66:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.JWTUserAuthError=t.JWTDriverAuthError=t.APIKeyAuthError=t.AuthError=void 0;class r extends Error{constructor(e){super(e),this.name="AuthError"}}t.AuthError=r,t.APIKeyAuthError=class extends r{constructor(e){super(e),this.name="APIKeyAuthError"}},t.JWTDriverAuthError=class extends r{constructor(e){super(e),this.name="JWTDriverAuthError"}},t.JWTUserAuthError=class extends r{constructor(e){super(e),this.name="JWTUserAuthError"}}},96:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(808);t.default=i.Auth},88:function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,s){function o(e){try{u(i.next(e))}catch(e){s(e)}}function a(e){try{u(i.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}u((i=i.apply(e,t||[])).next())}))},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.JWTAuth=void 0;const s=n(r(890)),o=r(259);t.JWTAuth=class{constructor({url:e,region:t,orgId:r,authType:i,email:n,password:s}){if(this.url=e,this.region=t,this.orgId=r,this.authType=i,this.email=n,this.password=s,this.tokenType=void 0,this.accessToken=void 0,this.expiresIn=void 0,this.refreshToken=void 0,this.refreshExpiresIn=void 0,this.lastRefreshTime=void 0,this.accountId=void 0,this.accountType=void 0,this.orgs=[],"driver"!==this.authType&&"user"!==this.authType)throw new Error("Invalid authType. Must be 'driver' or 'user'");if(this.url&&this.url.endsWith("/")&&(this.url=this.url.slice(0,-1)),!this.url){if(t&&!Object.values(o.regions).includes(t))throw new Error(`Invalid region. Must be one of: ${Object.values(o.regions).join(", ")}`);this.url=`https://${this.region}.nsurely-motor.com/v1/api`}if("user"===this.authType)this.loginUrl=`${this.url}/org/auth/users/login`,this.refreshUrl=`${this.url}/org/auth/users/refresh`,this.logoutUrl=`${this.url}/org/auth/users/logout`;else{if("driver"!==this.authType)throw new Error("Invalid authType. Must be 'driver' or 'user'");this.loginUrl=`${this.url}/org/${this.orgId}/auth/drivers/login`,this.refreshUrl=`${this.url}/org/${this.orgId}/auth/drivers/refresh`,this.logoutUrl=`${this.url}/org/${this.orgId}/auth/drivers/logout`}}refreshExpired(){return!this.lastRefreshTime||!this.refreshExpiresIn||this.refreshExpiresIn-(Date.now()-this.lastRefreshTime)<0}requiresRefresh(){return!this.accessToken||!this.expiresIn||!this.lastRefreshTime||this.expiresIn-(Date.now()-this.lastRefreshTime)<0}login(e,t){var r,n,o,a,u,c,h,l;return i(this,void 0,void 0,(function*(){const i=yield(0,s.default)({method:"POST",url:this.loginUrl,data:{email:e,password:t}});return this.tokenType=null===(r=i.body)||void 0===r?void 0:r.tokenType,this.accessToken=null===(n=i.body)||void 0===n?void 0:n.accessToken,this.expiresIn=null===(o=i.body)||void 0===o?void 0:o.expiresIn,this.refreshToken=null===(a=i.body)||void 0===a?void 0:a.refreshToken,this.refreshExpiresIn=null===(u=i.body)||void 0===u?void 0:u.refreshExpiresIn,this.accountId=null===(c=i.body)||void 0===c?void 0:c.accountId,this.accountType=null===(h=i.body)||void 0===h?void 0:h.accountType,"user"===this.authType&&(this.orgs=null===(l=i.body)||void 0===l?void 0:l.orgs),this.lastRefreshTime=Date.now(),this.accessToken}))}logout(){return i(this,void 0,void 0,(function*(){this.isLoggedIn()&&(yield(0,s.default)({method:"POST",url:this.logoutUrl,data:{refreshToken:this.refreshToken}}),this.accessToken=void 0,this.refreshToken=void 0,this.expiresIn=void 0,this.refreshExpiresIn=void 0,this.lastRefreshTime=void 0)}))}isLoggedIn(){return!(!this.accessToken||!this.expiresIn||!this.lastRefreshTime||!this.refreshExpiresIn||(this.refreshExpiresIn,Date.now(),this.lastRefreshTime,0))}refresh(){var e,t,r,n,o,a,u;return i(this,void 0,void 0,(function*(){if(this.refreshExpired())throw new Error("Refresh token expired due to inactivity. Please login again.");const i=yield(0,s.default)({method:"POST",url:this.refreshUrl,data:{refreshToken:this.refreshToken}});return this.tokenType=null===(e=i.body)||void 0===e?void 0:e.tokenType,this.accessToken=null===(t=i.body)||void 0===t?void 0:t.accessToken,this.expiresIn=null===(r=i.body)||void 0===r?void 0:r.expiresIn,this.refreshToken=null===(n=i.body)||void 0===n?void 0:n.refreshToken,this.refreshExpiresIn=null===(o=i.body)||void 0===o?void 0:o.refreshExpiresIn,this.accountId=null===(a=i.body)||void 0===a?void 0:a.accountId,this.accountType=null===(u=i.body)||void 0===u?void 0:u.accountType,this.lastRefreshTime=Date.now(),this.accessToken}))}getToken(){if(!this.accessToken)throw new Error("No access token or refresh token found. Please login first.");return`Bearer ${this.accessToken}`}getHeaders(){return this.accessToken?{Authorization:this.getToken()}:{}}}},537:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UserAuth=void 0;const i=r(88);class n extends i.JWTAuth{constructor({url:e,region:t,orgId:r,authType:i,email:n,password:s}){super({url:e,region:t,orgId:r,authType:i,email:n,password:s})}}t.UserAuth=n},465:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.deleteFromObject=t.isJsonString=t.applyMixins=void 0,t.applyMixins=function(e,t){t.forEach((t=>{Object.getOwnPropertyNames(t.prototype).forEach((r=>{Object.defineProperty(e.prototype,r,Object.getOwnPropertyDescriptor(t.prototype,r)||Object.create(null))}))}))},t.isJsonString=function(e=""){try{JSON.parse(e)}catch(e){return!1}return!0},t.deleteFromObject=function(e,t){for(var r in t)~r.indexOf(e)&&delete t[r]}},890:function(e,t){"use strict";var r=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,s){function o(e){try{u(i.next(e))}catch(e){s(e)}}function a(e){try{u(i.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}u((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.default=function({method:e,url:t,data:i=null,headers:n,params:s}){return new Promise(((o,a)=>{let u={method:e,redirect:"follow"},c=new Headers;if(i&&i instanceof FormData?u.body=i:i&&(c.append("Content-Type","application/json"),u.body=JSON.stringify(i)),n)for(const[e,t]of Object.entries(n))c.append(e,t);u.headers=c,fetch(`${t}?${new URLSearchParams(Object.assign({},s))}`,u).then((t=>function({response:e,method:t}){return e}({response:t,method:e}))).then((i=>{o(function({response:e,method:t,url:i,params:n}){return r(this,void 0,void 0,(function*(){if(e.status>=200&&e.status<300){if(204===e.status||205===e.status)return null;let t=yield e.json();return{status:e.status,body:t}}let r=yield e.text();throw function(e=""){try{JSON.parse(e)}catch(e){return!1}return!0}(r)&&(r=JSON.parse(r)),e.status,console.error("API call failed",{url:i,method:t,status:e.status,response:r,params:n}),{status:e.status,body:r}}))}({response:i,method:e,url:t,params:s}))})).catch((e=>{a(e)}))}))}},486:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Search=void 0;let r=["eq","ne","gt","gte","lt","lte","like","ilike"];t.Search=class{constructor({value:e,operator:t="eq"}){this.value=e,this.operator=t}_getValueString(){return this.value instanceof Date?this.value.toISOString():this.value.toString()}availableOperators(){return r}toString(){return`${this.operator}.${this._getValueString()}`}}},133:function(e,t,r){"use strict";var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,s){function o(e){try{u(i.next(e))}catch(e){s(e)}}function a(e){try{u(i.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}u((i=i.apply(e,t||[])).next())}))},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=n(r(797));class o{constructor(e=null){this.storage=new s.default({size:1e3,storageBackend:e,defaultExpires:null,enableCache:!0})}static createStorage(e=null){null==this.myInstance&&(this.myInstance=new o(e))}static getInstance(){if(null==this.myInstance)throw new Error("StorageManager has not been initialised. Initialise with StorageManager.createStorage(storageBackend)");return this.myInstance}save({key:e,data:t}){return i(this,void 0,void 0,(function*(){yield this.storage.save({key:e,data:t})}))}load({key:e}){return i(this,void 0,void 0,(function*(){return yield this.storage.load({key:e})}))}remove({key:e}){return i(this,void 0,void 0,(function*(){yield this.storage.remove({key:e})}))}}t.default=o}},t={};function r(i){var n=t[i];if(void 0!==n)return n.exports;var s=t[i]={exports:{}};return e[i].call(s.exports,s,s.exports,r),s.exports}r.d=(e,t)=>{for(var i in t)r.o(t,i)&&!r.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r(607)})();